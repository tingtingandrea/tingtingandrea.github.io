<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Studio Mademoiselle App</title>
  
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
	<script src="https://unpkg.com/akar-icons-fonts"></script>
	<link rel="stylesheet" href="./styleMademoiselle.css">


  <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-app.js"></script>
  
  <!-- TODO: Add SDKs for Firebase products that you want to use https://firebase.google.com/docs/web/setup#available-libraries -->
  <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-auth.js"></script>
  <!--<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-storage.js"></script>-->
  <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-storage.js"></script>
    
  
  <!-- FirebaseUI Auth -->
  <!-- https://firebaseopensource.com/projects/firebase/firebaseui-web/ -->
  <script src="https://www.gstatic.com/firebasejs/ui/4.7.3/firebase-ui-auth.js"></script>
  
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.17/dist/sweetalert2.all.min.js"></script>

  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/solid.min.css" rel="stylesheet">


  <script src= "https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"> </script>
  <script src="https://code.jquery.com/jquery-3.4.0.js"></script>

  <script src="scriptMademoiselle.js"></script>
</head>
<body>
<!-- partial:index.partial.html -->
<div class="phone">
	<header class="header">
		<div class="header-logo">
			<div>
				<span></span>
				<span></span>
				<span></span>
				<span></span>
			</div>
		</div>
		<div class="header-title">
			Home
		</div>
		<div class="header-buttons">
			<button class="notifications">
				<i class="ai-bell"></i>
			</button>
			<button class="avatar">
<img src="https://assets.codepen.io/285131/pexels-photo-838875.jpeg" />
			</button>
		</div>
	</header>
	<section class="title">
		<h1>Listening Everyday Test</h1>
		<p>Explore millions of music according to your taste</p>
	</section>
	<section class="search">
		<div class="search-inner">
			<button class="search-button">
				<i class="ai-search"></i>
			</button>
			<input type="text" class="search-input" placeholder="Search Music" />

		</div>
	</section>

	<nav class="navigation">
		<a href="#" class="navigation-item active">Overview</a>
		<a href="#" class="navigation-item">Songs</a>
		<a href="#" class="navigation-item">Albums</a>
		<a href="#" class="navigation-item">Artists</a>
	</nav>
	<section class="playlists">

		<article class="card">
			<div class="card-inner">
				<span class="card-pin"></span>
				<div class="card-image">
					<img src="https://assets.codepen.io/285131/illustration-hand-with-cigarette-icon.jpg" />
				</div>
				<div class="card-content">
					<div class="card-meta">
						<span class="card-meta-number">20 songs</span>
						<button class="card-meta-button">
							<i class="ai-circle-triangle-right-fill"></i>
						</button>
					</div>
					<h2 class="card-title">Alan Walker</h2>
				</div>
			</div>
		</article>

		<article class="card">
			<div class="card-inner">
				<span class="card-pin"></span>
				<div class="card-image">
					<img src="https://assets.codepen.io/285131/hand-drawn-monster-milkshake.jpg" />
				</div>
				<div class="card-content">
					<div class="card-meta">
						<span class="card-meta-number">20 songs</span>
						<button class="card-meta-button">
							<i class="ai-circle-triangle-right-fill"></i>
						</button>
					</div>
					<h2 class="card-title">Tim Bergling</h2>
				</div>
			</div>
		</article>
	</section>
	<section class="currently-playing">

		<article class="card horizontal">
			<div class="card-inner">
				<span class="card-pin simple"></span>
				<div class="card-image">
					<img src="https://assets.codepen.io/285131/pink-pastel-juicy-banana.jpg" />
				</div>
				<div class="card-content">
					<div class="card-meta">
						<span class="card-meta-artist">Marshmello</span>
						<button class="card-meta-button" style="opacity: 0;">
							<i class="ai-circle-triangle-right-fill"></i>
						</button>
					</div>
					<h2 class="card-title">Hate the Other Side
						<span class="card-time">3:40</span>
					</h2>
				</div>
				<span class="card-pin simple"></span>
			</div>
		</article>
	</section>
	<footer class="menu">
		<div class="menu-inner">
			<a href="#" class="menu-item active">
				<i class="ai-home"></i>
			</a>
			<a href="#" class="menu-item">
				<i class="ai-heart"></i>
			</a>
			<a href="#" class="menu-item">
				<i class="ai-fire"></i>
			</a>
			<a href="#" class="menu-item">
				<i class="ai-gear"></i>
			</a>
		</div>
	</footer>
</div>
<!-- partial -->
  <script src='https://unpkg.com/akar-icons-fonts'></script><script  src="./script.js"></script>

</body>
<script>
	
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: process.env.FIREBASE_API_KEY,
      authDomain: "studio-mademoiselle-f0510.firebaseapp.com",
      projectId: "studio-mademoiselle-f0510",
      storageBucket: "studio-mademoiselle-f0510.firebasestorage.app",
      messagingSenderId: "581494827788",
      appId: "1:581494827788:web:ceffa170cbf8d9222ef729",
      measurementId: "G-MQC0X172KD"
    };
  
    // Initialize Firebase
    var myProfile;
    var userID;
    var myEvent;
    var dancersData = {};
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const provider = new firebase.auth.GoogleAuthProvider();
    const storage = firebase.storage();
    var firstLogin = true;

    window.addEventListener("load", async function () {
      await auth.onAuthStateChanged( async function(user) {
        if (user) {
          // User is signed in.
          console.log("User is signed in:", user);
          // You can now update the UI to show the user's info
        } else {
          // No user is signed in.
          console.log("No user is signed in");
          // Redirect to login page or show a login button
          Swal.fire({title: "Welcome to Studio Mademoiselle",
            showDenyButton: true,
            //showCancelButton: true,
            //confirmButtonText: 'Email',
            denyButtonText: 'Testing',
            confirmButtonText: 'Sign in',
            //denyButtonColor: "var(--c-gray-500)",
            //cancelButtonText: 'Google',
            //cancelButtonColor: "var(--c-blue-500)",
          }).then( async function(result) {
            //console.log(result);
            if (result.isConfirmed) {
                auth.signInWithPopup(provider)
                    .then((result) => {
                        const user = result.user;
                        //userID = user.uid;
                        console.log('User signed in with Google:', user);
                        //Swal.fire('Signed in with Google successfully!', '', 'success');
                    })
                    .catch((error) => {
                        console.error('Error signing in with Google:', error);
                        Swal.fire('Error signing in with Google', error.message, 'error');
                    });

                /*Swal.fire({
                    title: 'Enter your email and password',
                    html:
                        '<input type="email" id="email" class="swal2-input" placeholder="Email">' +
                        '<input type="password" id="password" class="swal2-input" placeholder="Password">',
                    focusConfirm: false,
                    preConfirm: () => {
                        const email = Swal.getPopup().querySelector('#email').value;
                        const password = Swal.getPopup().querySelector('#password').value;
                        if (!email || !password) {
                            Swal.showValidationMessage(`Please enter email and password`);
                        }
                        return { email: email, password: password };
                    }
                }).then((loginDetails) => {
                    if (loginDetails.value) {
                        auth.signInWithEmailAndPassword(loginDetails.value.email, loginDetails.value.password)
                            .then((userCredential) => {
                                // Signed in
                                const user = userCredential.user;
                                //console.log('User signed in:', user);
                                //userID = user.uid;
                                //Swal.fire('Signed in successfully!', '', 'success');
                            })
                            .catch((error) => {
                                console.error('Error signing in:', error);
                                Swal.fire('Error signing in', error.message, 'error');
                            })
                            .catch((error) => {
                                if (error.code === 'auth/user-not-found') {
                                    // If user is not found, sign them up
                                    auth.createUserWithEmailAndPassword(loginDetails.value.email, loginDetails.value.password)
                                        .then((userCredential) => {
                                            const user = userCredential.user;
                                            console.log('User signed up and signed in:', user);
                                        })
                                        .catch((error) => {
                                            console.error('Error signing up:', error);
                                            Swal.fire('Error signing up', error.message, 'error');
                                        });
                                } else {
                                    console.error('Error signing in:', error);
                                    Swal.fire('Error signing in', error.message, 'error');
                                }
                            });
                    }
                });*/
            } else if (result.isDenied) {
                await auth.signInAnonymously()
                    .then((result) => {
                        const user = result.user;
                        //userID = "test";
                        console.log('User signed in anonymously:', user);
                        //Swal.fire('Signed in anonymously successfully!', '', 'success');
                    })
                    .catch((error) => {
                        console.error('Error signing in anonymously:', error);
                        Swal.fire('Error signing in anonymously', error.message, 'error');
                    });
            } else if (result.dismiss === Swal.DismissReason.cancel) {
          }
          //await setupFirebase();
          //Login and setup profile
          firstLogin = true;
          });
        }
        userID = user.uid;
        //userID = "RMETHBA9CEdhaPvLrYThM4Hv9073";
        console.log(userID);
        //if ( user.isAnonymous ) userID = "test";
        await setupFirebase();
      });
    });

    const logoutButton = document.getElementById('logoutButton');

</script>
</html>
